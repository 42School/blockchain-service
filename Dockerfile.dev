FROM debian:buster-backports

RUN apt-get update -y && apt-get upgrade -y

RUN apt-get install -y software-properties-common python3-gpg

RUN add-apt-repository "deb http://ppa.launchpad.net/ethereum/ethereum/ubuntu xenial main"

RUN apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 0x2A518C819BE37D2C2031944D1C52189C923F6CA9

RUN apt update -y && apt upgrade -y

RUN apt-get install -y golang-1.13 ethereum git make grep nodejs npm sed

RUN npm install -g npm@latest

RUN npm install -g truffle solc

COPY . /blockchain-service

ENV PATH=/usr/lib/go-1.13/bin:$PATH

ENV KEYPASSWD="password"

ENV KEYSTOREPATHSIGN="./keystore-sign"

ENV KEYSTOREPATH="./keystore"

ENV FTENDPOINT="http://127.0.0.1:8080"

ENV VALIDATIONPATH="/check-request"

ENV RETRYPATH="/check-request"

ENV EMAILSENDER="emailSender"

ENV TOKEN="token"

ENV PASSWDEMAIL="password"

#ENV NETWORKLINK="https://ropsten.infura.io/v3/8389b141c43c4143abf48183bb477bb6"

#ENV ADDRESSCONTRACT="0x7dd6b2e41C3F07f16785c943B1eF6ad6eB2e34D1" Old contract

ENV ADDRESSCONTRACT="0x29A5C09219A5c71A81d26922D708E472677F4548"

ENV RUNENV="Dev"

EXPOSE 8080:8080

CMD cd /blockchain-service && make go-compile && ./blockchain-service